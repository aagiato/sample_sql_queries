SELECT
  o.order_id,
  o.order_date,
  c.customer_name,
  p.product_name,
  oi.quantity,
  s.shipment_date,
  s.carrier
FROM orders o
JOIN customers c
  ON o.customer_id = c.customer_id
LEFT JOIN order_items oi
  ON o.order_id = oi.order_id
JOIN products p
  ON oi.product_id = p.product_id
LEFT JOIN shipments s
  ON o.order_id = s.order_id
WHERE o.order_status = 'Completed'
  AND s.shipment_date >= o.order_date
ORDER BY o.order_date DESC
